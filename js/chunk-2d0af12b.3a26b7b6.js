(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0af12b"],{"0d89":function(t,e,o){"use strict";o.r(e);var a=o("7a23");const n={class:"table mt-4 container-fluid"},s=Object(a["h"])("thead",null,[Object(a["h"])("tr",null,[Object(a["h"])("th",null,"優惠碼"),Object(a["h"])("th",null,"折扣百分比"),Object(a["h"])("th",null,"到期日"),Object(a["h"])("th",null,"是否啟用"),Object(a["h"])("th",{class:"text-center"},"編輯")])],-1),c={key:0,class:"text-success"},l={key:1,class:"text-muted"},i={class:"d-flex justify-content-center"},d={class:"btn-group"},p=["onClick"],u=["onClick"];function h(t,e,o,h,b,r){const m=Object(a["I"])("Loading"),j=Object(a["I"])("CouponModal"),O=Object(a["I"])("DelModal");return Object(a["z"])(),Object(a["g"])(a["a"],null,[Object(a["k"])(m,{active:b.isLoading},null,8,["active"]),Object(a["h"])("button",{type:"button",class:"btn btn-primary px-5 rounded-0 text-white mt-2",onClick:e[0]||(e[0]=t=>r.openCouponModal(!0))}," 建立新的優惠券 "),Object(a["h"])("table",n,[s,(Object(a["z"])(!0),Object(a["g"])(a["a"],null,Object(a["G"])(b.coupons,(e,o)=>(Object(a["z"])(),Object(a["g"])("tbody",{key:o},[Object(a["h"])("tr",null,[Object(a["h"])("td",null,Object(a["L"])(e.code),1),Object(a["h"])("td",null,Object(a["L"])(e.percent)+"%",1),Object(a["h"])("td",null,Object(a["L"])(t.$filters.date(e.due_date)),1),Object(a["h"])("td",null,[1==e.is_enabled?(Object(a["z"])(),Object(a["g"])("span",c,"啟用")):(Object(a["z"])(),Object(a["g"])("span",l,"未啟用"))]),Object(a["h"])("td",i,[Object(a["h"])("div",d,[Object(a["h"])("button",{onClick:t=>r.openCouponModal(!1,e),type:"button",class:"btn btn-outline-primary btn-sm"},"編輯",8,p),Object(a["h"])("button",{onClick:t=>r.openDelCouponModal(e),type:"button",class:"btn btn-outline-danger btn-sm"},"刪除",8,u)])])])]))),128))]),Object(a["k"])(j,{coupon:b.tempCoupon,ref:"couponModal",onUpdateCoupon:r.updateCoupon},null,8,["coupon","onUpdateCoupon"]),Object(a["k"])(O,{item:b.tempCoupon,ref:"delModal",onDelItem:r.delCoupon},null,8,["item","onDelItem"])],64)}const b={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},r={class:"modal-dialog",role:"document"},m={class:"modal-content"},j=Object(a["h"])("div",{class:"modal-header"},[Object(a["h"])("h5",{class:"modal-title",id:"exampleModalLabel"},"Modal title"),Object(a["h"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),O={class:"modal-body"},C={class:"mb-3"},g=Object(a["h"])("label",{for:"title"},"標題",-1),f={class:"mb-3"},M=Object(a["h"])("label",{for:"coupon_code"},"優惠碼",-1),v={class:"mb-3"},y=Object(a["h"])("label",{for:"due_date"},"到期日",-1),w={class:"mb-3"},_=Object(a["h"])("label",{for:"price"},"折扣百分比",-1),k={class:"mb-3"},$={class:"form-check"},x=Object(a["h"])("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),L={class:"modal-footer"},V=Object(a["h"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function D(t,e,o,n,s,c){return Object(a["z"])(),Object(a["g"])("div",b,[Object(a["h"])("div",r,[Object(a["h"])("div",m,[j,Object(a["h"])("div",O,[Object(a["h"])("div",C,[g,Object(a["V"])(Object(a["h"])("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":e[0]||(e[0]=t=>s.tempCoupon.title=t),placeholder:"請輸入標題"},null,512),[[a["P"],s.tempCoupon.title]])]),Object(a["h"])("div",f,[M,Object(a["V"])(Object(a["h"])("input",{type:"text",class:"form-control",id:"coupon_code","onUpdate:modelValue":e[1]||(e[1]=t=>s.tempCoupon.code=t),placeholder:"請輸入優惠碼"},null,512),[[a["P"],s.tempCoupon.code]])]),Object(a["h"])("div",v,[y,Object(a["V"])(Object(a["h"])("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":e[2]||(e[2]=t=>s.due_date=t)},null,512),[[a["P"],s.due_date]])]),Object(a["h"])("div",w,[_,Object(a["V"])(Object(a["h"])("input",{type:"number",class:"form-control",id:"price","onUpdate:modelValue":e[3]||(e[3]=t=>s.tempCoupon.percent=t),placeholder:"請輸入折扣百分比"},null,512),[[a["P"],s.tempCoupon.percent,void 0,{number:!0}]])]),Object(a["h"])("div",k,[Object(a["h"])("div",$,[Object(a["V"])(Object(a["h"])("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,"onUpdate:modelValue":e[4]||(e[4]=t=>s.tempCoupon.is_enabled=t),id:"is_enabled"},null,512),[[a["O"],s.tempCoupon.is_enabled]]),x])])]),Object(a["h"])("div",L,[V,Object(a["h"])("button",{type:"button",class:"btn btn-primary",onClick:e[5]||(e[5]=e=>t.$emit("update-coupon",s.tempCoupon))},"更新優惠券 ")])])])],512)}var U=o("e0ae"),z={name:"couponModal",props:{coupon:{}},data(){return{tempCoupon:{},due_date:""}},emits:["update-coupon"],watch:{coupon(){this.tempCoupon=this.coupon;const t=new Date(1e3*this.tempCoupon.due_date).toISOString().split("T");[this.due_date]=t},due_date(){this.tempCoupon.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[U["a"]]},I=o("6b0d"),P=o.n(I);const S=P()(z,[["render",D]]);var N=S,J=o("6ff1"),T={data(){return{coupons:[],tempCoupon:{title:"",is_enabled:0,percent:100,code:""},isLoading:!1,isNew:!1}},components:{CouponModal:N,DelModal:J["a"]},inject:["emitter"],methods:{openCouponModal(t,e){this.isNew=t,this.isNew?this.tempCoupon={due_date:(new Date).getTime()/1e3}:this.tempCoupon={...e},this.$refs.couponModal.showModal()},openDelCouponModal(t){this.tempCoupon={...t};const e=this.$refs.delModal;e.showModal()},getCoupons(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/coupons";this.isLoading=!0,this.$http.get(t,this.tempProduct).then(t=>{this.isLoading=!1,this.coupons=t.data.coupons}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message}),this.isLoading=!1})},updateCoupon(t){if(this.isNew){const e="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/coupon";this.$http.post(e,{data:t}).then(t=>{this.$httpMessageState(t,"新增優惠券"),this.getCoupons(),this.$refs.couponModal.hideModal()}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message}),this.isLoading=!1})}else{const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/coupon/"+this.tempCoupon.id;this.$http.put(t,{data:this.tempCoupon}).then(t=>{this.$httpMessageState(t,"編輯優惠券"),this.getCoupons(),this.$refs.couponModal.hideModal()}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message}),this.isLoading=!1})}},delCoupon(){const t="https://vue3-course-api.hexschool.io/api/tracytung-vue-api/admin/coupon/"+this.tempCoupon.id;this.isLoading=!0,this.$http.delete(t).then(t=>{this.$httpMessageState(t,"刪除優惠券");const e=this.$refs.delModal;this.isLoading=!1,e.hideModal(),this.getCoupons()}).catch(t=>{this.$swal({icon:"error",title:""+t.data.message}),this.isLoading=!1})}},created(){this.getCoupons()}};const G=P()(T,[["render",h]]);e["default"]=G}}]);
//# sourceMappingURL=chunk-2d0af12b.3a26b7b6.js.map